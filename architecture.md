# Описание работы jwt сервиса

### Функционал

| Путь     | Case                                                           | Метод | Возвращаемое значение      | Описание                                                       | Статус |
|----------|----------------------------------------------------------------|-------|----------------------------|----------------------------------------------------------------|--------|
| /{guid}  | Получение токенов и сохранение                                 | GET   | -                          | Создаётся пара токенов с payload{id, guid, iat, exp, jti}      | 200    |
| /refresh | Обновление валидных токенов                                    | GET   | -                          | Проверяются на валидность токены и созадётся                   | 200    |
| /refresh | Обновление невалидных (структура payload не совпадает) токенов | GET   | Wrong data structure       | При проверке токена стурктура не совпала                       | 400    |
| /refresh | Обновление невалидных (изменены токены) токенов                | GET   | Not valid token            | При проверке токена подпись не совпала                         | 401    |
| /refresh | Обновление невалидных (пара токенов не связана) токенов        | GET   | Not valid token pair       | При проверке jti (идентификатора токенов) у токенов не совпали | 401    |
| /refresh | Обноваление невалидных (refresh токен был использован) токенов | GET   | Token used before          | При проверке jti токенов был не активный (использован ранее)   | 401    |
| /refresh | Обновление невалидных (запрос с нового IP) токенов             | GET   | You're location is blocked | При проверке payload токенов IP выдачи и IP запроса не совпали | 401    |

### Внутренние инструменты
- [pkg/clientip](./pkg/clientip/clientip.go) - модуль для получения IP из net/http запроса
- [pkg/database](./pkg/database/connection.go) - подуль для создания подключения к базе данных
- [pkg/mail](./pkg/mail/gmail.go) - модуль отправки сообщений при помощи gmail SMTP подключения
- [pkg/tokens](./pkg/tokens/jwt.go) - модуль генерации и обработки JWT токенов